# kafka为什么会出现重复消费问题

消费者本地执行完逻辑后，准备提交offset，但是还没有提交；然后机器重启了，那么kafka就不知道消费者刚刚已经消费过的消息，于是kafka又将上次的消息重新推送给消费者。那么消费者这里就会出现重复消费的问题。

# 如何保证幂等性

## 非高并发场景

下面以支付为例，在不考虑并发的情况下，实现幂等很简单：①先查询一下订单是否已经支付过，②如果已经支付过，则返回支付成功；如果没有支付，进行支付流程，修改订单状态为‘已支付’。
