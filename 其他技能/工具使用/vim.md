


# 文件夹

todo

# 日志查看

## more

todo 

类似cat，不过会以一页一页的形式显示，按空白键space就往下一页显示，按b键就会往回一页显示

```
more demo.log

// 执行结果(文件内容少的话，会直接显示全部，效果跟cat一样)：
line1 123456 aa
line2 123456 bb
line3 123456 cc
--More--(15%)
```

## less

todo 

- less中查找

	```
	// 使用斜杠（/）加关键字的形式，向后查找关键字，如查找关键字：123456
	/123456   
	
	// 使用问号（?）加关键字的形式，向前查找关键字，如查找关键字：line3
	?line3
	
	// PS：跳转到后一个关键字快捷键: N; 跳转到前一个关键字：shift + N
	```

## cat

- 查询关键词所在的行号

	```
	cat -n test.log |grep "地形"
	```

- 某行的前后10行

	得到"地形"关键字所在的行号是100行. 此时如果我想查看这个关键字前10行和后10行的日志:
	
	```
	cat -n test.log |tail -n +90|head -n 20
	```
	
	tail -n +92表示查询92行之后的日志
	
	head -n 20 则表示在前面的查询结果里再查前20条记录
	
- 查询结果输出到文件

	```
	cat -n test.log |grep "地形"  >xxx.txt
	```

## grep

- 并且

	// 查询包含关键字`123456`且包含`aa`的日志内容
	
	```
	grep "123456" demo.log | grep "aa"
	
	// 执行结果
	line1 123456 aa
	```
	
- 或者

	// 查询包含关键字`123456`或`aa`的日志内容
	
	```
	grep "123456\|aa" demo.log
	或者
	grep -E "123456|aa" demo.log
	```
	
- 取反

	// 查询不包含`aa`的日志内容
	
	```
	grep -v "aa" demo.log
	
	// 执行结果
	line2 123456 bb
	line3 123456 cc
	line4 123456 dd
	line6 654321 bb
	```
	
	// 查询包含关键字`123456`但不包含`aa`的日志内容
	
	```
	grep "123456" demo.log | grep -v "aa"
	
	// 执行结果
	line2 123456 bb
	line3 123456 cc
	line4 123456 dd
	```

- grep打印匹配的上下几行

	如果在只是想匹配模式的上下几行，grep可以实现。
	 
	```
	$grep -5 ‘parttern’ inputfile //打印匹配行的前后5行
	 
	$grep -C 5 ‘parttern’ inputfile //打印匹配行的前后5行
	 
	$grep -A 5 ‘parttern’ inputfile //打印匹配行的后5行
	 
	$grep -B 5 ‘parttern’ inputfile //打印匹配行的前5行
	```

## head

- 头10行

	```
	head -n 10  test.log   查询日志文件中的头10行日志;
	```
	
- 开始到倒数10行/查询日志文件除了最后10行的其他所有日志

	```
	head -n -10  test.log   查询日志文件除了最后10行的其他所有日志;
	```	

## tail 

- 实时输出日志

	```
	tail -f xxx //实时显示(默认10行)
	tail -2f demo.log	// 显示文件倒数2行数据，并实时刷新新日志
	```

- 最后10行
	
	```
	tail  -n  10  test.log   查询日志尾部最后10行的日志
	```

- 第10行开始到最后/查询10行之后的所有日志

	```
	tail -n +10 test.log    查询10行之后的所有日志;
	```

- 显示102行,前10行和后10行的日志

	```
	cat -n app.log |tail -n +92|head -n 20
	```

## sed

- 查看某一个文件第5行和第10行

	```
	sed -n '5,10p' filename //这样你就可以只查看文件的第5行到第10行。
	```

- 按日期查找

	那么按日期怎么查呢?  通常我们非常需要查找指定时间端的日志
	
	特别说明:上面的两个日期必须是日志中打印出来的日志,否则无效.
	
	```
	sed -n '/2019-05-13 00:45:58/,/2019-05-13 00:45:59/p' jmeter.log
	```
	可以先根据某个log关键词，或者数据库的更新时间，找到一个时间；
	然后在执行sed

# vim

> 文件大小

du -h fileName

```
du -h cindydeMacBook-Air.local-ss_micro_app_wxtelesphorus_lt_biz.log
```

## 常用操作
以下操作在普通模式下执行，连续按键

### 移动

```
j 向下
30j 向下移动30行
k 向上
h 向左
l 向右
0 到行首
^ 到行首第一个字符，如果前面有空格的话
$ 到行尾
gg 快速到文件头
G 快速到文件尾
100G 跳转到第100行
```
不建议在插入模式下进行光标移动，这很低效

### 复制 y

```
yy 复制一行
10yy 向下复制10行
yw 复制光标开始的一个单词
y$ 复制光标到行尾
yfB 复制光标到第一个大写B中间的内容
y2fB 复制光标到第二个大写B中间的内容
```

### 剪切 x

```
x 向剪切一个一个字符，如果是在行尾，则为向前剪切
3x 剪切三个
xp 非行尾交换两个字符，如从bs变成sb
```

### 删除：d
删除的内容会放到剪贴板，按p即可粘贴到其他地方

```
dd 删除一行
200dd 删除200行
dw 删除一个单词 （最喜欢啦）
df" 删除到出现的第一个双引号
```

### 粘贴: p

```
p 粘贴复制或剪切的内容
3p 将复制或剪切的内容粘贴三次
```

## 可视化模式

### v 行模式，选择一些内容
可视化模式是非常有用的一种模式，在普通模式下按v即可进入。 使用h、j、k、l进行漫游，选中相应的内容。

例子，选中一部分想要的内容，并删除。
![](vim_v.png)

## 查找字符串
同样的，正则的知识也可以应用*

在普通模式下，按下/直接进入查找，输入相应的字符串按确定即可。

```
n 查找下一个匹配
N 查找上一个匹配
2n 查找下面第二个匹配
```
如果觉得跳来跳去晕头转向，可以在命令模式下输入set nu开启行号。


## 退出编辑器

```
wq 保存当前文件并退出
wqa 保存所有文件并退出
q! 不保存，直接退出
qa! 有多个文件被打开，同时退出
```


本篇文章只聚焦常用功能，帮助读者快速处理线上文本。至于更多的，也装不下，只有你自己去探索喽。
vim的入门门槛比较高，幸运的是，用多了，你就无法释手了。

# sed



# 参考文献
- [Linux生产环境上，最常用的一套“vim“技巧](https://juejin.im/post/5bfa4211e51d4550184546ea)
- [linux查找日志技巧](https://www.cnblogs.com/chjbbs/p/5761741.html)
- [Linux日志查找关键字](https://blog.csdn.net/zeng308041977/article/details/80339370)
- [如何在Linux下优雅的查询日志](https://www.cnblogs.com/Trainoo/p/9218830.html)